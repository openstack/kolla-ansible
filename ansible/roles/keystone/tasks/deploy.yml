---
- name: Configure keystone
  import_tasks: config.yml

- name: Check keystone containers
  import_tasks: check-containers.yml

- name: Clone keystone repository
  include_tasks: clone.yml
  when:
    - keystone_dev_mode | bool

- name: Bootstrap keystone service
  import_tasks: bootstrap.yml

- name: Flush handlers
  meta: flush_handlers

- name: Include tasks from distribute_fernet.yml
  include_tasks: distribute_fernet.yml

- name: Register keystone in Keystone
  import_tasks: register.yml

- name: Include tasks from register_identity_providers.yml
  include_tasks: register_identity_providers.yml
  when:
    - enable_keystone_federation | bool
