---
fixes:
  - |
    Fixes a regression in the Valkey upgrade process where the
    ``valkey_master_host`` variable was not defined if the Redis migration
    block was skipped. This led to a fatal error during the
    "Wait for Valkey replication sync" task due to the interaction between
    ``run_once`` and ``delegate_to``. The variable is now defined globally
    at the start of the upgrade tasks.
    `LP#2138440 <https://launchpad.net/bugs/2138440>`__
